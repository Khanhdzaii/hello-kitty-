--// Hello Kitty Glass UI FINAL (Mobile Safe + Sound)
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local UIS = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local SoundService = game:GetService("SoundService")
local player = Players.LocalPlayer

-- ================= SOUND (NO ASSET) =================
local function PlayUISound()
	pcall(function()
		local s = Instance.new("Sound")
		s.Volume = 0.5
		s.Parent = SoundService
		s:Play()
		game:GetService("Debris"):AddItem(s, 0.2)
	end)
end

-- ================= GUI =================
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "HelloKittyUI"
ScreenGui.Parent = player:WaitForChild("PlayerGui")
ScreenGui.ResetOnSpawn = false

local Blur = Instance.new("BlurEffect")
Blur.Size = 0
Blur.Parent = game:GetService("Lighting")

local Main = Instance.new("Frame", ScreenGui)
Main.Size = UDim2.fromOffset(520,360)
Main.Position = UDim2.fromScale(0.5,0.5)
Main.AnchorPoint = Vector2.new(0.5,0.5)
Main.BackgroundTransparency = 0.88
Main.BorderSizePixel = 0
Main.ClipsDescendants = true

local Corner = Instance.new("UICorner", Main)
Corner.CornerRadius = UDim.new(0,24)

-- ================= TITLE =================
local Title = Instance.new("Frame", Main)
Title.Size = UDim2.new(1,0,0,42)
Title.BackgroundTransparency = 1

local TitleText = Instance.new("TextLabel", Title)
TitleText.Size = UDim2.new(1,-80,1,0)
TitleText.Position = UDim2.fromOffset(16,0)
TitleText.Text = "Hello Kitty UI"
TitleText.Font = Enum.Font.GothamBold
TitleText.TextSize = 18
TitleText.TextXAlignment = Left
TitleText.TextColor3 = Color3.new(1,1,1)
TitleText.BackgroundTransparency = 1

local MinBtn = Instance.new("TextButton", Title)
MinBtn.Size = UDim2.fromOffset(32,32)
MinBtn.Position = UDim2.new(1,-38,0.5,-16)
MinBtn.Text = "-"
MinBtn.Font = Enum.Font.GothamBold
MinBtn.TextSize = 22
MinBtn.TextColor3 = Color3.new(1,1,1)
MinBtn.BackgroundTransparency = 0.3
MinBtn.BorderSizePixel = 0
Instance.new("UICorner", MinBtn).CornerRadius = UDim.new(1,0)

-- ================= CONTENT =================
local Content = Instance.new("Frame", Main)
Content.Position = UDim2.fromOffset(0,42)
Content.Size = UDim2.new(1,0,1,-42)
Content.BackgroundTransparency = 1

local Layout = Instance.new("UIListLayout", Content)
Layout.Padding = UDim.new(0,8)

-- ================= COLOR CYCLE =================
task.spawn(function()
	local t = 0
	while ScreenGui.Parent do
		t += RunService.RenderStepped:Wait()
		local a = (math.sin(t*2)+1)/2
		local c = Color3.new(1, 0.8 + 0.2*a, 0.85 + 0.15*a)
		Main.BackgroundColor3 = c
		MinBtn.BackgroundColor3 = c
	end
end)

-- ================= DRAG (PC + MOBILE) =================
do
	local dragging, startPos, dragStart

	Title.InputBegan:Connect(function(i)
		if i.UserInputType == Enum.UserInputType.MouseButton1
		or i.UserInputType == Enum.UserInputType.Touch then
			dragging = true
			dragStart = i.Position
			startPos = Main.Position
		end
	end)

	UIS.InputChanged:Connect(function(i)
		if dragging and (i.UserInputType == Enum.UserInputType.MouseMovement
		or i.UserInputType == Enum.UserInputType.Touch) then
			local d = i.Position - dragStart
			Main.Position = UDim2.new(
				startPos.X.Scale, startPos.X.Offset + d.X,
				startPos.Y.Scale, startPos.Y.Offset + d.Y
			)
		end
	end)

	UIS.InputEnded:Connect(function(i)
		if i.UserInputType == Enum.UserInputType.MouseButton1
		or i.UserInputType == Enum.UserInputType.Touch then
			dragging = false
		end
	end)
end

-- ================= OPEN / CLOSE =================
local OPEN = true
local FULL_SIZE = Main.Size

local function ToggleUI()
	PlayUISound()
	if OPEN then
		OPEN = false
		MinBtn.Text = "+"
		Content.Visible = false
		TweenService:Create(Main, TweenInfo.new(0.35), {
			Size = UDim2.fromOffset(520,42)
		}):Play()
		TweenService:Create(Blur, TweenInfo.new(0.35), {Size = 0}):Play()
	else
		OPEN = true
		MinBtn.Text = "-"
		Content.Visible = true
		TweenService:Create(Main, TweenInfo.new(0.35), {
			Size = FULL_SIZE
		}):Play()
		TweenService:Create(Blur, TweenInfo.new(0.35), {Size = 18}):Play()
	end
end

MinBtn.MouseButton1Click:Connect(ToggleUI)

UIS.InputBegan:Connect(function(i,g)
	if g then return end
	if i.KeyCode == Enum.KeyCode.RightControl then
		ToggleUI()
	end
end)

-- ================= LIB =================
local Library = {}

function Library:AddToggle(text, cb)
	local B = Instance.new("TextButton", Content)
	B.Size = UDim2.new(1,-20,0,40)
	B.Position = UDim2.fromOffset(10,0)
	B.Text = text.." : OFF"
	B.Font = Enum.Font.Gotham
	B.TextSize = 14
	B.TextColor3 = Color3.new(1,1,1)
	B.BackgroundTransparency = 0.4
	B.BorderSizePixel = 0
	Instance.new("UICorner", B).CornerRadius = UDim.new(0,14)

	local state = false
	B.MouseButton1Click:Connect(function()
		PlayUISound()
		state = not state
		B.Text = text.." : "..(state and "ON" or "OFF")
		pcall(cb,state)
	end)
end

function Library:AddSlider(text,min,max,cb)
	local H = Instance.new("Frame", Content)
	H.Size = UDim2.new(1,-20,0,50)
	H.BackgroundTransparency = 1

	local L = Instance.new("TextLabel", H)
	L.Size = UDim2.new(1,0,0,20)
	L.Text = text
	L.Font = Enum.Font.Gotham
	L.TextSize = 14
	L.TextColor3 = Color3.new(1,1,1)
	L.BackgroundTransparency = 1

	local Bar = Instance.new("Frame", H)
	Bar.Position = UDim2.fromOffset(0,28)
	Bar.Size = UDim2.new(1,0,0,8)
	Bar.BackgroundTransparency = 0.6
	Instance.new("UICorner", Bar)

	local Fill = Instance.new("Frame", Bar)
	Fill.Size = UDim2.fromScale(0,1)
	Fill.BackgroundColor3 = Color3.fromRGB(255,105,180)
	Instance.new("UICorner", Fill)

	local dragging = false
	Bar.InputBegan:Connect(function(i)
		if i.UserInputType == Enum.UserInputType.MouseButton1
		or i.UserInputType == Enum.UserInputType.Touch then
			dragging = true -- ❌ không sound
		end
	end)
	Bar.InputEnded:Connect(function(i)
		if i.UserInputType == Enum.UserInputType.MouseButton1
		or i.UserInputType == Enum.UserInputType.Touch then
			dragging = false
		end
	end)

	UIS.InputChanged:Connect(function(i)
		if dragging then
			local pct = math.clamp((i.Position.X-Bar.AbsolutePosition.X)/Bar.AbsoluteSize.X,0,1)
			Fill.Size = UDim2.fromScale(pct,1)
			pcall(cb, math.floor(min+(max-min)*pct))
		end
	end)
end

function Library:AddDropdown(text,opts,cb)
	local B = Instance.new("TextButton", Content)
	B.Size = UDim2.new(1,-20,0,40)
	B.Text = text
	B.Font = Enum.Font.Gotham
	B.TextSize = 14
	B.TextColor3 = Color3.new(1,1,1)
	B.BackgroundTransparency = 0.4
	B.BorderSizePixel = 0
	Instance.new("UICorner", B)

	B.MouseButton1Click:Connect(function()
		PlayUISound()
		for _,v in ipairs(opts) do
			local O = Instance.new("TextButton", Content)
			O.Size = UDim2.new(1,-40,0,30)
			O.Text = v
			O.Font = Enum.Font.Gotham
			O.TextSize = 13
			O.TextColor3 = Color3.new(1,1,1)
			O.BackgroundTransparency = 0.45
			Instance.new("UICorner", O)

			O.MouseButton1Click:Connect(function()
				PlayUISound()
				pcall(cb,v)
				O:Destroy()
			end)
		end
	end)
end

return Library
